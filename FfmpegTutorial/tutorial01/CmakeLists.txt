cmake_minimum_required(VERSION 3.10)
project(Tutorial01)

set(CMAKE_CXX_STANDARD 11)
set(CMAKE_CXX_STANDARD_REQUIRED True)

# Set this to your FFmpeg include directory
set(FFMPEG_INCLUDE_DIR ../../ThirdLib/ffmpeg_install/include)

# Set this to your FFmpeg lib directory
set(FFMPEG_LIB_DIR ../../../ThirdLib/ffmpeg_install/bin)
set(FFMPEG_DEV_ROOT ../../ThirdLib/ffmpeg_install)
# Set x264 library directorys
set(X264_LIB_DIR ../../../ThirdLib/x264_install/bin)

include_directories(${FFMPEG_INCLUDE_DIR})
link_directories(${FFMPEG_DEV_ROOT}/bin)

add_executable(tutorial01 tutorial01.c)

# Specify the static libraries from FFmpeg you're linking against
target_link_libraries(tutorial01 
    avformat
    avcodec
    avutil
    avfilter
    swresample
    # Add any other FFmpeg libraries you need here
    swscale
)

# 在 Windows 上，复制 FFmpeg 的 DLLs 到可执行文件同一目录
if(WIN32)
    add_custom_command(TARGET tutorial01 POST_BUILD
        COMMAND ${CMAKE_COMMAND} -E copy_if_different
        "${FFMPEG_LIB_DIR}/avcodec-61.dll"
        "${FFMPEG_LIB_DIR}/avformat-61.dll"
        "${FFMPEG_LIB_DIR}/avutil-59.dll"
        "${FFMPEG_LIB_DIR}/avfilter-10.dll"
        "${X264_LIB_DIR}/libx264-164.dll"
        "${FFMPEG_LIB_DIR}/swresample-5.dll"
        "${FFMPEG_LIB_DIR}/swscale-8.dll"
        $<TARGET_FILE_DIR:tutorial01>)
endif()

# If you're using MSVC, you might need to suppress some warnings or set specific compiler options
if(MSVC)
    # 仅对 MSVC 编译器
    target_compile_options(tutorial01 PRIVATE /W3)
else()
    # 对 GCC 或 Clang 等其他编译器
    target_compile_options(tutorial01 PRIVATE -Wall -Wextra)
endif()

